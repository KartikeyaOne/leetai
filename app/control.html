<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'">
    <title>LeetAI Controls</title>
    <link rel="stylesheet" href="control-styles.css"> <!-- Main styles for the control bar -->
</head>
<body>
    <!-- Changed to div for more styling flexibility if needed -->
    <div class="control-bar">
        <div class="logo">
            <span>LeetAI</span>
        </div>
        <!-- Simplified: Only necessary controls visible -->
        <div class="controls-group">
             <button class="control-btn" id="main-view-btn" data-tab="main" title="Switch to Main View (Currently Only View)">
                <!-- Placeholder Icon (replace with SVG or remove) -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path fill-rule="evenodd" d="M4.25 2A2.25 2.25 0 002 4.25v11.5A2.25 2.25 0 004.25 18h11.5A2.25 2.25 0 0018 15.75V4.25A2.25 2.25 0 0015.75 2H4.25zm0 1.5a.75.75 0 000 1.5h11.5a.75.75 0 000-1.5H4.25zM7 8a.75.75 0 01.75-.75h4.5a.75.75 0 010 1.5h-4.5A.75.75 0 017 8zm0 4a.75.75 0 01.75-.75h4.5a.75.75 0 010 1.5h-4.5A.75.75 0 017 12z" clip-rule="evenodd" /></svg>
                <span>Main</span>
             </button>
            <!-- Add settings button here later if needed -->
            <!-- <button class="control-btn" data-tab="settings" title="Settings">⚙️</button> -->
            <div class="separator"></div>
            <button class="control-btn" id="ghost-mode-toggle" title="Toggle Interaction Mode (Cmd/Ctrl+G)">
                <!-- Dynamically updated content via JS -->
                Interactive Mode
            </button>
        </div>
    </div>

    <script>
        if (typeof require === 'function') {
            const { ipcRenderer } = require('electron');
             document.addEventListener('DOMContentLoaded', () => {
                console.log('Control Renderer: DOM Ready');
                const ghostBtn = document.getElementById('ghost-mode-toggle');
                const mainViewBtn = document.getElementById('main-view-btn'); // Only relevant button now

                if (!ghostBtn || !mainViewBtn) { console.error("Control UI elements missing!"); return; }

                // --- Main View Button (No actual switching needed yet) ---
                mainViewBtn.addEventListener('click', () => {
                    if (!mainViewBtn.classList.contains('active')) { // Only send if not active
                         console.log("Control: Main View btn clicked.");
                         document.querySelectorAll('.control-btn[data-tab]').forEach(b => b.classList.remove('active'));
                         mainViewBtn.classList.add('active');
                         ipcRenderer.send('switch-tab', 'main'); // Still useful for resetting state if other tabs were added
                     }
                });
                mainViewBtn.classList.add('active'); // Start active

                // --- Ghost Mode Toggle ---
                ghostBtn.addEventListener('click', () => ipcRenderer.send('toggle-ghost-mode'));

                // --- IPC Updates ---
                ipcRenderer.on('update-ghost-mode-ui', (event, isGhost) => {
                     ghostBtn.textContent = isGhost ? 'Ghost Mode' : 'Interactive Mode';
                     ghostBtn.classList.toggle('interactive', !isGhost); // Add class when NOT ghost
                     ghostBtn.title = isGhost ? 'Ghost Mode (Clicks pass through). Ctrl+G to Interact.' : 'Interactive Mode (Clickable). Ctrl+G for Ghost Mode.';
                });
                ipcRenderer.on('toggle-visibility', (event, data) => console.log('Control visibility:', data.isVisible));
                console.log('Control Renderer: Initialized.');
             });
        } else { console.error("Electron require() unavailable."); }
    </script>
</body>
</html>